{% extends "base.html" %}

{% block title %}Products - Wholesale Management{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <!-- Header with Add Button -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="h3 text-dark fw-bold mb-0">Product Management</h1>
            <p class="text-muted mb-0">Manage your product catalog with colors and sizes</p>
        </div>
        <button type="button" class="btn btn-primary btn-lg" data-bs-toggle="modal" data-bs-target="#productModal">
            <i class="fas fa-plus me-2"></i>Add New Product
        </button>
    </div>

    <!-- Brand Filter Tabs -->
    <div class="card shadow-sm mb-4">
        <div class="card-body py-3">
            <ul class="nav nav-pills nav-fill" id="brandTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active fw-semibold" id="all-tab" data-bs-toggle="pill" data-bs-target="#all-products" type="button" role="tab">
                        <i class="fas fa-th-large me-2"></i>All Products
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link fw-semibold" id="shared-tab" data-bs-toggle="pill" data-bs-target="#shared-products" type="button" role="tab">
                        <i class="fas fa-boxes me-2"></i>URBRAND/SURVACCI
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link fw-semibold" id="aziz-tab" data-bs-toggle="pill" data-bs-target="#aziz-products" type="button" role="tab">
                        <i class="fas fa-star me-2"></i>AZIZ
                    </button>
                </li>
            </ul>
        </div>
    </div>

    <!-- Product Grid -->
    <div class="tab-content" id="brandTabsContent">
        <!-- All Products -->
        <div class="tab-pane fade show active" id="all-products" role="tabpanel">
            <div class="row g-4">
                {% for product in products %}
                <div class="col-xl-4 col-lg-6 col-md-6">
                    <div class="card h-100 shadow-sm border-0 product-card">
                        <div class="card-header bg-white border-bottom-0 pb-0">
                            <div class="d-flex justify-content-between align-items-start">
                                <div>
                                    <h5 class="card-title mb-1 fw-bold text-dark">{{ product.name }}</h5>
                                    <span class="badge {% if product.brand_group == 'SHARED' %}bg-primary{% else %}bg-warning text-dark{% endif %} mb-2">
                                        {% if product.brand_group == 'SHARED' %}URBRAND/SURVACCI{% else %}AZIZ{% endif %}
                                    </span>
                                </div>
                                <div class="dropdown">
                                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                        <i class="fas fa-ellipsis-v"></i>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li><a class="dropdown-item" href="{{ url_for('edit_product', id=product.id) }}">
                                            <i class="fas fa-edit me-2"></i>Edit
                                        </a></li>
                                        <li>
                                            <form method="POST" action="{{ url_for('delete_product', id=product.id) }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this product?')">
                                                <button type="submit" class="dropdown-item text-danger border-0 bg-transparent">
                                                    <i class="fas fa-trash me-2"></i>Delete
                                                </button>
                                            </form>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-body pt-2">
                            <!-- Price Information -->
                            <div class="row mb-3">
                                <div class="col-6">
                                    <div class="text-center p-2 bg-light rounded">
                                        <div class="small text-muted">Cost Price</div>
                                        <div class="fw-bold text-success">{{ "%.2f"|format(product.cost_price) }} EGP</div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="text-center p-2 bg-light rounded">
                                        <div class="small text-muted">Selling Price</div>
                                        <div class="fw-bold text-primary">{{ "%.2f"|format(product.selling_price) }} EGP</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Available Colors -->
                            <div class="mb-3">
                                <div class="small text-muted fw-semibold mb-2">Available Colors</div>
                                <div class="d-flex flex-wrap gap-1">
                                    {% if product.available_colors %}
                                        {% for color in product.available_colors.split(',') %}
                                            <span class="badge color-badge" style="background-color: {% if color.strip() == 'Black' %}#000000{% elif color.strip() == 'White' %}#ffffff; color: #000000; border: 1px solid #ddd{% elif color.strip() == 'Green' %}#28a745{% elif color.strip() == 'Petrol' %}#17a2b8{% elif color.strip() == 'Burgundy' %}#6f1e1e{% elif color.strip() == 'Brown' %}#8b4513{% elif color.strip() == 'Baby Pink' %}#ffb6c1; color: #000000{% else %}#6c757d{% endif %}">
                                                {{ color.strip() }}
                                            </span>
                                        {% endfor %}
                                    {% else %}
                                        <span class="text-muted small">No colors set</span>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- Available Sizes -->
                            <div class="mb-3">
                                <div class="small text-muted fw-semibold mb-2">Available Sizes</div>
                                <div class="d-flex flex-wrap gap-1">
                                    {% if product.available_sizes %}
                                        {% for size in product.available_sizes.split(',') %}
                                            <span class="badge bg-secondary size-badge">{{ size.strip() }}</span>
                                        {% endfor %}
                                    {% else %}
                                        <span class="text-muted small">No sizes set</span>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- Profit Margin -->
                            <div class="mt-auto">
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="small text-muted">Profit Margin</span>
                                    <span class="fw-bold text-success">
                                        {{ "%.2f"|format(product.selling_price - product.cost_price) }} EGP
                                        ({{ "%.1f"|format(((product.selling_price - product.cost_price) / product.cost_price * 100) if product.cost_price > 0 else 0) }}%)
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}

                {% if not products %}
                <div class="col-12">
                    <div class="text-center py-5">
                        <i class="fas fa-box-open fa-3x text-muted mb-3"></i>
                        <h4 class="text-muted">No products yet</h4>
                        <p class="text-muted">Start by adding your first product using the button above.</p>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Shared Products Tab -->
        <div class="tab-pane fade" id="shared-products" role="tabpanel">
            <div class="row g-4">
                {% for product in products %}
                    {% if product.brand_group == 'SHARED' %}
                    <div class="col-xl-4 col-lg-6 col-md-6">
                        <div class="card h-100 shadow-sm border-0 product-card">
                            <div class="card-header bg-white border-bottom-0 pb-0">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div>
                                        <h5 class="card-title mb-1 fw-bold text-dark">{{ product.name }}</h5>
                                        <span class="badge bg-primary mb-2">URBRAND/SURVACCI</span>
                                    </div>
                                    <div class="dropdown">
                                        <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                            <i class="fas fa-ellipsis-v"></i>
                                        </button>
                                        <ul class="dropdown-menu">
                                            <li><a class="dropdown-item" href="{{ url_for('edit_product', id=product.id) }}">
                                                <i class="fas fa-edit me-2"></i>Edit
                                            </a></li>
                                            <li>
                                                <form method="POST" action="{{ url_for('delete_product', id=product.id) }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this product?')">
                                                    <button type="submit" class="dropdown-item text-danger border-0 bg-transparent">
                                                        <i class="fas fa-trash me-2"></i>Delete
                                                    </button>
                                                </form>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card-body pt-2">
                                <!-- Price Information -->
                                <div class="row mb-3">
                                    <div class="col-6">
                                        <div class="text-center p-2 bg-light rounded">
                                            <div class="small text-muted">Cost Price</div>
                                            <div class="fw-bold text-success">{{ "%.2f"|format(product.cost_price) }} EGP</div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="text-center p-2 bg-light rounded">
                                            <div class="small text-muted">Selling Price</div>
                                            <div class="fw-bold text-primary">{{ "%.2f"|format(product.selling_price) }} EGP</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Available Colors -->
                                <div class="mb-3">
                                    <div class="small text-muted fw-semibold mb-2">Available Colors</div>
                                    <div class="d-flex flex-wrap gap-1">
                                        {% if product.available_colors %}
                                            {% for color in product.available_colors.split(',') %}
                                                <span class="badge color-badge" style="background-color: {% if color.strip() == 'Black' %}#000000{% elif color.strip() == 'White' %}#ffffff; color: #000000; border: 1px solid #ddd{% elif color.strip() == 'Green' %}#28a745{% elif color.strip() == 'Petrol' %}#17a2b8{% elif color.strip() == 'Burgundy' %}#6f1e1e{% elif color.strip() == 'Brown' %}#8b4513{% elif color.strip() == 'Baby Pink' %}#ffb6c1; color: #000000{% else %}#6c757d{% endif %}">
                                                    {{ color.strip() }}
                                                </span>
                                            {% endfor %}
                                        {% else %}
                                            <span class="text-muted small">No colors set</span>
                                        {% endif %}
                                    </div>
                                </div>

                                <!-- Available Sizes -->
                                <div class="mb-3">
                                    <div class="small text-muted fw-semibold mb-2">Available Sizes</div>
                                    <div class="d-flex flex-wrap gap-1">
                                        {% if product.available_sizes %}
                                            {% for size in product.available_sizes.split(',') %}
                                                <span class="badge bg-secondary size-badge">{{ size.strip() }}</span>
                                            {% endfor %}
                                        {% else %}
                                            <span class="text-muted small">No sizes set</span>
                                        {% endif %}
                                    </div>
                                </div>

                                <!-- Profit Margin -->
                                <div class="mt-auto">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="small text-muted">Profit Margin</span>
                                        <span class="fw-bold text-success">
                                            {{ "%.2f"|format(product.selling_price - product.cost_price) }} EGP
                                            ({{ "%.1f"|format(((product.selling_price - product.cost_price) / product.cost_price * 100) if product.cost_price > 0 else 0) }}%)
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                {% endfor %}
                
                {% if not products or not products|selectattr('brand_group', 'equalto', 'SHARED')|list %}
                <div class="col-12">
                    <div class="text-center py-5">
                        <i class="fas fa-box-open fa-3x text-muted mb-3"></i>
                        <h4 class="text-muted">No URBRAND/SURVACCI products yet</h4>
                        <p class="text-muted">Create products for the shared storage system.</p>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- AZIZ Products Tab -->
        <div class="tab-pane fade" id="aziz-products" role="tabpanel">
            <div class="row g-4">
                {% for product in products %}
                    {% if product.brand_group == 'AZIZ' %}
                    <div class="col-xl-4 col-lg-6 col-md-6">
                        <div class="card h-100 shadow-sm border-0 product-card">
                            <div class="card-header bg-white border-bottom-0 pb-0">
                                <div class="d-flex justify-content-between align-items-start">
                                    <div>
                                        <h5 class="card-title mb-1 fw-bold text-dark">{{ product.name }}</h5>
                                        <span class="badge bg-warning text-dark mb-2">AZIZ</span>
                                    </div>
                                    <div class="dropdown">
                                        <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                            <i class="fas fa-ellipsis-v"></i>
                                        </button>
                                        <ul class="dropdown-menu">
                                            <li><a class="dropdown-item" href="{{ url_for('edit_product', id=product.id) }}">
                                                <i class="fas fa-edit me-2"></i>Edit
                                            </a></li>
                                            <li>
                                                <form method="POST" action="{{ url_for('delete_product', id=product.id) }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this product?')">
                                                    <button type="submit" class="dropdown-item text-danger border-0 bg-transparent">
                                                        <i class="fas fa-trash me-2"></i>Delete
                                                    </button>
                                                </form>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card-body pt-2">
                                <!-- Price Information -->
                                <div class="row mb-3">
                                    <div class="col-6">
                                        <div class="text-center p-2 bg-light rounded">
                                            <div class="small text-muted">Cost Price</div>
                                            <div class="fw-bold text-success">{{ "%.2f"|format(product.cost_price) }} EGP</div>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="text-center p-2 bg-light rounded">
                                            <div class="small text-muted">Selling Price</div>
                                            <div class="fw-bold text-primary">{{ "%.2f"|format(product.selling_price) }} EGP</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Available Colors -->
                                <div class="mb-3">
                                    <div class="small text-muted fw-semibold mb-2">Available Colors</div>
                                    <div class="d-flex flex-wrap gap-1">
                                        {% if product.available_colors %}
                                            {% for color in product.available_colors.split(',') %}
                                                <span class="badge color-badge" style="background-color: {% if color.strip() == 'Black' %}#000000{% elif color.strip() == 'White' %}#ffffff; color: #000000; border: 1px solid #ddd{% elif color.strip() == 'Green' %}#28a745{% elif color.strip() == 'Petrol' %}#17a2b8{% elif color.strip() == 'Burgundy' %}#6f1e1e{% elif color.strip() == 'Brown' %}#8b4513{% elif color.strip() == 'Baby Pink' %}#ffb6c1; color: #000000{% else %}#6c757d{% endif %}">
                                                    {{ color.strip() }}
                                                </span>
                                            {% endfor %}
                                        {% else %}
                                            <span class="text-muted small">No colors set</span>
                                        {% endif %}
                                    </div>
                                </div>

                                <!-- Available Sizes -->
                                <div class="mb-3">
                                    <div class="small text-muted fw-semibold mb-2">Available Sizes</div>
                                    <div class="d-flex flex-wrap gap-1">
                                        {% if product.available_sizes %}
                                            {% for size in product.available_sizes.split(',') %}
                                                <span class="badge bg-secondary size-badge">{{ size.strip() }}</span>
                                            {% endfor %}
                                        {% else %}
                                            <span class="text-muted small">No sizes set</span>
                                        {% endif %}
                                    </div>
                                </div>

                                <!-- Profit Margin -->
                                <div class="mt-auto">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="small text-muted">Profit Margin</span>
                                        <span class="fw-bold text-success">
                                            {{ "%.2f"|format(product.selling_price - product.cost_price) }} EGP
                                            ({{ "%.1f"|format(((product.selling_price - product.cost_price) / product.cost_price * 100) if product.cost_price > 0 else 0) }}%)
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                {% endfor %}
                
                {% if not products or not products|selectattr('brand_group', 'equalto', 'AZIZ')|list %}
                <div class="col-12">
                    <div class="text-center py-5">
                        <i class="fas fa-box-open fa-3x text-muted mb-3"></i>
                        <h4 class="text-muted">No AZIZ products yet</h4>
                        <p class="text-muted">Create products for the separate AZIZ storage system.</p>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Product Modal -->
<div class="modal fade" id="productModal" tabindex="-1" aria-labelledby="productModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="productModalLabel">
                    <i class="fas fa-plus me-2"></i>Add New Product
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form method="POST" action="{{ url_for('new_product') }}" id="productForm">
                {% if form %}
                    {{ form.hidden_tag() }}
                {% endif %}
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="productName" class="form-label fw-semibold">Product Name</label>
                                <input type="text" class="form-control form-control-lg" id="productName" name="name" required>
                            </div>
                            
                            <div class="mb-3">
                                <label for="brandGroup" class="form-label fw-semibold">Brand Group</label>
                                <select class="form-select form-select-lg" id="brandGroup" name="brand_group" required>
                                    <option value="">Choose brand group...</option>
                                    <option value="SHARED">URBRAND/SURVACCI (Shared Storage)</option>
                                    <option value="AZIZ">AZIZ (Separate Storage)</option>
                                </select>
                            </div>

                            <div class="row">
                                <div class="col-6">
                                    <div class="mb-3">
                                        <label for="costPrice" class="form-label fw-semibold">Cost Price</label>
                                        <div class="input-group">
                                            <input type="number" step="0.01" class="form-control form-control-lg" id="costPrice" name="cost_price" required>
                                            <span class="input-group-text">EGP</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="mb-3">
                                        <label for="sellingPrice" class="form-label fw-semibold">Selling Price</label>
                                        <div class="input-group">
                                            <input type="number" step="0.01" class="form-control form-control-lg" id="sellingPrice" name="selling_price" required>
                                            <span class="input-group-text">EGP</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="availableColors" class="form-label fw-semibold">Available Colors</label>
                                <div class="color-selection-area border rounded p-3" style="min-height: 120px; background: #f8f9fa;">
                                    <div class="row g-2">
                                        <div class="col-6 col-md-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="Black" id="colorBlack" name="available_colors">
                                                <label class="form-check-label d-flex align-items-center" for="colorBlack">
                                                    <span class="color-swatch me-2" style="background-color: #000000;"></span>
                                                    Black
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-6 col-md-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="White" id="colorWhite" name="available_colors">
                                                <label class="form-check-label d-flex align-items-center" for="colorWhite">
                                                    <span class="color-swatch me-2" style="background-color: #ffffff; border: 1px solid #ddd;"></span>
                                                    White
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-6 col-md-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="Green" id="colorGreen" name="available_colors">
                                                <label class="form-check-label d-flex align-items-center" for="colorGreen">
                                                    <span class="color-swatch me-2" style="background-color: #28a745;"></span>
                                                    Green
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-6 col-md-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="Petrol" id="colorPetrol" name="available_colors">
                                                <label class="form-check-label d-flex align-items-center" for="colorPetrol">
                                                    <span class="color-swatch me-2" style="background-color: #17a2b8;"></span>
                                                    Petrol
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-6 col-md-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="Burgundy" id="colorBurgundy" name="available_colors">
                                                <label class="form-check-label d-flex align-items-center" for="colorBurgundy">
                                                    <span class="color-swatch me-2" style="background-color: #6f1e1e;"></span>
                                                    Burgundy
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-6 col-md-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="Brown" id="colorBrown" name="available_colors">
                                                <label class="form-check-label d-flex align-items-center" for="colorBrown">
                                                    <span class="color-swatch me-2" style="background-color: #8b4513;"></span>
                                                    Brown
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-6 col-md-4">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="Baby Pink" id="colorBabyPink" name="available_colors">
                                                <label class="form-check-label d-flex align-items-center" for="colorBabyPink">
                                                    <span class="color-swatch me-2" style="background-color: #ffb6c1;"></span>
                                                    Baby Pink
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="availableSizes" class="form-label fw-semibold">Available Sizes</label>
                                <div class="size-selection-area border rounded p-3" style="background: #f8f9fa;">
                                    <div class="row g-2">
                                        <div class="col-4 col-md-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="XS" id="sizeXS" name="available_sizes">
                                                <label class="form-check-label" for="sizeXS">XS</label>
                                            </div>
                                        </div>
                                        <div class="col-4 col-md-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="S" id="sizeS" name="available_sizes">
                                                <label class="form-check-label" for="sizeS">S</label>
                                            </div>
                                        </div>
                                        <div class="col-4 col-md-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="M" id="sizeM" name="available_sizes">
                                                <label class="form-check-label" for="sizeM">M</label>
                                            </div>
                                        </div>
                                        <div class="col-4 col-md-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="L" id="sizeL" name="available_sizes">
                                                <label class="form-check-label" for="sizeL">L</label>
                                            </div>
                                        </div>
                                        <div class="col-4 col-md-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="XL" id="sizeXL" name="available_sizes">
                                                <label class="form-check-label" for="sizeXL">XL</label>
                                            </div>
                                        </div>
                                        <div class="col-4 col-md-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="XXL" id="sizeXXL" name="available_sizes">
                                                <label class="form-check-label" for="sizeXXL">XXL</label>
                                            </div>
                                        </div>
                                        <div class="col-4 col-md-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="XXXL" id="sizeXXXL" name="available_sizes">
                                                <label class="form-check-label" for="sizeXXXL">3XL</label>
                                            </div>
                                        </div>
                                        <div class="col-4 col-md-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="XXXXL" id="sizeXXXXL" name="available_sizes">
                                                <label class="form-check-label" for="sizeXXXXL">4XL</label>
                                            </div>
                                        </div>
                                        <div class="col-4 col-md-3">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="XXXXXL" id="sizeXXXXXL" name="available_sizes">
                                                <label class="form-check-label" for="sizeXXXXXL">5XL</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary btn-lg">
                        <i class="fas fa-save me-2"></i>Save Product
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Custom CSS -->
<style>
.product-card {
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.product-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.15) !important;
}

.color-badge {
    padding: 0.4rem 0.7rem;
    border-radius: 1rem;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin: 0.1rem;
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
}

.size-badge {
    padding: 0.3rem 0.6rem;
    border-radius: 0.5rem;
    font-size: 0.75rem;
    font-weight: 600;
    margin: 0.1rem;
}

.color-swatch {
    display: inline-block;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    border: 1px solid rgba(0,0,0,0.1);
}

.nav-pills .nav-link {
    border-radius: 0.5rem;
    margin: 0 0.25rem;
    transition: all 0.2s ease;
}

.nav-pills .nav-link.active {
    background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
    color: white;
    box-shadow: 0 4px 15px rgba(162, 93, 40, 0.3);
}

.color-selection-area, .size-selection-area {
    max-height: 150px;
    overflow-y: auto;
}

.form-check-label {
    font-size: 0.9rem;
    font-weight: 500;
    cursor: pointer;
}

.form-check-input:checked {
    background-color: var(--accent-primary);
    border-color: var(--accent-primary);
}
</style>

<script>
// Add event listeners when page loads
document.addEventListener('DOMContentLoaded', function() {
    const costInput = document.getElementById('costPrice');
    const sellingInput = document.getElementById('sellingPrice');
    
    if (costInput && sellingInput) {
        costInput.addEventListener('input', updateProfitDisplay);
        sellingInput.addEventListener('input', updateProfitDisplay);
    }
});

// Reset form when modal is closed
document.getElementById('productModal').addEventListener('hidden.bs.modal', function () {
    document.getElementById('productForm').reset();
});

// Real-time profit calculation
function updateProfitDisplay() {
    const cost = parseFloat(document.getElementById('costPrice').value) || 0;
    const selling = parseFloat(document.getElementById('sellingPrice').value) || 0;
    
    if (cost > 0 && selling > 0) {
        const margin = selling - cost;
        const percentage = (margin / cost * 100).toFixed(1);
        
        // Update visual feedback
        const costInput = document.getElementById('costPrice');
        const sellingInput = document.getElementById('sellingPrice');
        
        if (selling <= cost) {
            sellingInput.classList.add('is-invalid');
            costInput.classList.add('is-invalid');
        } else {
            sellingInput.classList.remove('is-invalid');
            costInput.classList.remove('is-invalid');
            sellingInput.classList.add('is-valid');
            costInput.classList.add('is-valid');
        }
    }
}
</script>
{% endblock %}